import{a as E}from"./chunk-VBYF6GSZ.js";import{a as j}from"./chunk-AH3ZPUKH.js";import{i as P}from"./chunk-TLXHLPPZ.js";import{B as v,La as f,M as S,Ma as _,Na as R,Oa as W,Pa as k,Qa as l,Ra as d,Ta as g,V as b,Va as m,Wa as a,Z as c,_ as s,ba as I,e as M,fa as u,hb as x,jb as w,lc as V,pa as p,vb as y,xa as C,yb as T,zb as D}from"./chunk-LF3VOW3X.js";function O(n){n||(n=b(I));let e=new M(t=>n.onDestroy(t.next.bind(t)));return t=>t.pipe(S(e))}var N=(n,e)=>e.id;function H(n,e){if(n&1){let t=g();l(0,"app-media-card",4),m("untrack",function(){let r=c(t).$implicit,i=a(2);return s(i.untrack.emit(r))})("markWatched",function(){let r=c(t).$implicit,i=a(2);return s(i.markWatched.emit(r))}),d()}if(n&2){let t=e.$implicit;k("media",t)}}function $(n,e){if(n&1&&(l(0,"div",2),R(1,H,1,1,"app-media-card",3,N),d()),n&2){let t=a();p(),W(t.media())}}var h=class n{name=D.required();media=D.required();show=u(!0);untrack=T();markWatched=T();toggleShow(){this.show.update(e=>!e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["app-collection"]],inputs:{name:[1,"name"],media:[1,"media"]},outputs:{untrack:"untrack",markWatched:"markWatched"},decls:6,vars:3,consts:[["mat-icon-button","",3,"click"],[1,"responsive-icon"],[1,"collection"],[3,"media"],[3,"untrack","markWatched","media"]],template:function(t,o){t&1&&(l(0,"h2")(1,"button",0),m("click",function(){return o.toggleShow()}),l(2,"mat-icon",1),x(3),d()(),x(4),d(),f(5,$,3,0,"div",2)),t&2&&(p(3),w(" ",o.show()?"remove":"add"),p(),w(" ",o.name(),`
`),p(),_(o.show()?5:-1))},dependencies:[V,E,P],styles:["h2[_ngcontent-%COMP%]{display:flex;align-items:center}.collection[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem}"]})};function A(n,e){if(n&1){let t=g();l(0,"app-collection",2),m("untrack",function(r){c(t);let i=a();return s(i.untrack(r))})("markWatched",function(r){c(t);let i=a();return s(i.markWatched(r))}),d()}if(n&2){let t=a();k("media",t.released())}}function L(n,e){if(n&1){let t=g();l(0,"app-collection",3),m("untrack",function(r){c(t);let i=a();return s(i.untrack(r))})("markWatched",function(r){c(t);let i=a();return s(i.markWatched(r))}),d()}if(n&2){let t=a();k("media",t.unreleased())}}var q=class n{mediaHttpClient=b(j);tracked=u([]);showReleased=u(!0);showUnreleased=u(!0);released=y(()=>this.tracked().filter(e=>this.hasReleased(e)));unreleased=y(()=>this.tracked().filter(e=>!this.hasReleased(e)));constructor(){this.mediaHttpClient.getTracked().pipe(O()).subscribe(e=>this.tracked.set(e))}untrack(e){this.mediaHttpClient.untrack(e).pipe(v(1)).subscribe()}hasReleased(e){let t=new Date;return e.mediaType==="MOVIE"||e.mediaType==="GAME"?!!e.releaseDate&&new Date(e.releaseDate)<=t:!!e.lastReleased&&!!e.lastWatchedAt&&e.lastWatchedAt<e.lastReleased}toggleShowReleased(){this.showReleased.update(e=>!e)}toggleShowUnreleased(){this.showUnreleased.update(e=>!e)}markWatched(e){this.mediaHttpClient.markWatched(e).pipe(v(1)).subscribe()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["app-tracked"]],decls:2,vars:2,consts:[["name","Released",3,"media"],["name","Coming Sooon",3,"media"],["name","Released",3,"untrack","markWatched","media"],["name","Coming Sooon",3,"untrack","markWatched","media"]],template:function(t,o){t&1&&(f(0,A,1,1,"app-collection",0),f(1,L,1,1,"app-collection",1)),t&2&&(_(o.released().length?0:-1),p(),_(o.unreleased().length?1:-1))},dependencies:[h],styles:[".collection[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem}h2[_ngcontent-%COMP%]{display:flex;align-items:center}"]})};export{q as TrackedPage};
